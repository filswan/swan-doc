# 3.1å‡†å¤‡å‘é€äº¤æ˜“çš„æ•°æ®

## åˆ›å»ºcaræ–‡ä»¶

*   ğŸ””è¾“å…¥è·¯å¾„å’Œè¾“å‡ºè·¯å¾„åªèƒ½æ˜¯ç»å¯¹è·¯å¾„ã€‚

    ğŸ”” æ­¤æ­¥éª¤å¯¹äºæ‰€æœ‰çš„æ¨¡å¼çš„ä»»åŠ¡éƒ½æ˜¯å¿…éœ€çš„ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©ä»¥ä¸‹ä¸‰ç§æ–¹å¼ä¸­çš„ä»»æ„ä¸€ç§

#### é€‰é¡¹1ï¸âƒ£ é€šè¿‡ Lotus <a href="#xuan-xiang-one-tong-guo-lotus" id="xuan-xiang-one-tong-guo-lotus"></a>

ğŸ”” è¿™ä¸ªé€‰é¡¹å°†ä¸ºæºç›®å½•ä¸­çš„æ¯ä¸ªæ–‡ä»¶ç”Ÿæˆä¸€ä¸ªCaræ–‡ä»¶

```shell
./swan-client car -input-dir [input_files_dir] -out-dir [car_files_output_dir]
```

**æ­¤å‘½ä»¤ç›¸å…³å‚æ•°å¦‚ä¸‹:**

* \-input-dir(å¿…é€‰): æºæ–‡ä»¶æ‰€åœ¨è·¯å¾„
* \-out-dir(å¯é€‰): ç”Ÿæˆçš„Caræ–‡ä»¶å’Œå…ƒæ•°æ®æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼Œå½“ç¼ºçœæ—¶ï¼Œä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„`[sender].output_dir`

**æ­¤æ­¥éª¤ç”¨åˆ°çš„é…ç½®é¡¹:**

* \[lotus].client\_api\_url, è§é…ç½®æ–‡ä»¶
* \[lotus].client\_access\_token, è§é…ç½®æ–‡ä»¶
* \[sender].output\_dir, åªæœ‰å½“å‘½ä»¤ä¸­`-out-dir`ç¼ºçœæ—¶æ‰ä¼šè¢«ä½¿ç”¨,è§é…ç½®æ–‡ä»¶
* \[sender].generate\_md5, å½“è®¾ç½®ä¸ºtrueæ—¶ï¼Œä¼šç”Ÿæˆæºæ–‡ä»¶å’ŒCaræ–‡ä»¶çš„md5,è§é…ç½®æ–‡ä»¶

**æ­¤æ­¥éª¤ä¹‹åç”Ÿæˆçš„æ–‡ä»¶:**

* car.json: åŒ…å«æºæ–‡ä»¶å’ŒCaræ–‡ä»¶çš„ä¿¡æ¯, è§ç¦»çº¿äº¤æ˜“
* \[source-file-name].car: æ¯ä¸ªæºæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„Caræ–‡ä»¶

#### é€‰é¡¹2ï¸âƒ£ é€šè¿‡ Graphsplit <a href="#xuan-xiang-two-tong-guo-graphsplit" id="xuan-xiang-two-tong-guo-graphsplit"></a>

ğŸ”” è¯¥é€‰é¡¹å¯ä»¥å°†æºç›®å½•ä¸‹çš„æ–‡ä»¶æˆ–æ•´ä¸ªç›®å½•ä¸­çš„æ–‡ä»¶åˆ†å‰²åˆ°è¾“å‡ºç›®å½•ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªCaræ–‡ä»¶ã€‚

```shell
./swan-client gocar -input-dir [input_files_dir] -out-dir [car_files_output_dir]
```

**æ­¤å‘½ä»¤ç›¸å…³å‚æ•°å¦‚ä¸‹:**

* \-input-dir(å¿…é€‰): æºæ–‡ä»¶æ‰€åœ¨è·¯å¾„
* \-out-dir(å¯é€‰): ç”Ÿæˆçš„Caræ–‡ä»¶å’Œå…ƒæ•°æ®æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼Œå½“ç¼ºçœæ—¶ï¼Œä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„`[sender].output_dir`

**æ­¤æ­¥éª¤ç”¨åˆ°çš„é…ç½®é¡¹:**

* \[lotus].client\_api\_url, è§é…ç½®æ–‡ä»¶
* \[lotus].client\_access\_token, è§é…ç½®æ–‡ä»¶
* \[sender].gocar\_file\_size\_limit, è§é…ç½®æ–‡ä»¶
* \[sender].gocar\_folder\_based, è§é…ç½®æ–‡ä»¶
* \[sender].output\_dir, åªæœ‰å½“å‘½ä»¤ä¸­-out-dirç¼ºçœæ—¶æ‰ä¼šè¢«ä½¿ç”¨, è§é…ç½®æ–‡ä»¶
* \[sender].generate\_md5, å½“è®¾ç½®ä¸ºtrueæ—¶ï¼Œä¼šç”Ÿæˆæºæ–‡ä»¶å’ŒCaræ–‡ä»¶çš„md5, è§\[é…ç½®æ–‡ä»¶

**æ­¤æ­¥éª¤ä¹‹åç”Ÿæˆçš„æ–‡ä»¶:**

* manifest.csv: é€šè¿‡ `graphsplit api`ç”Ÿæˆ
* car.json: æ ¹æ®`manifest.csv`ç”Ÿæˆï¼ŒåŒ…å«æºæ–‡ä»¶å’ŒCaræ–‡ä»¶çš„ä¿¡æ¯, è§ç¦»çº¿äº¤æ˜“
* \[hash-value-of-file-part].car: iå¦‚æœ`gocar_folder_based=true`ï¼Œè·¯å¾„ä¸‹é¢ä¼šæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªCaræ–‡ä»¶ï¼Œå¦åˆ™æ¯ä¸ªæºæ–‡ä»¶ä¼šæ ¹æ®æ–‡ä»¶å¤§å°å’Œ`[sender].gocar_file_size_limit`ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªCaræ–‡ä»¶ä¸ä¹‹ç›¸å¯¹åº”ã€‚

**æ³¨æ„:**

* å¦‚æœæºæ–‡ä»¶çš„å¤§å°è¦å¤§äº`[sender].gocar_file_size_limit`ï¼Œåœ¨å…ƒæ•°æ®æ–‡ä»¶ä¸­çš„åŸæ–‡ä»¶ä¿¡æ¯æ˜¯ç”±`graphsplit api`ä¸´æ—¶ç”Ÿæˆçš„ï¼Œåœ¨ç”ŸæˆCaræ–‡ä»¶ä¹‹åï¼Œè¿™äº›ä¸´æ—¶æ€§çš„åŸæ–‡ä»¶å°†ä¼šè¢«`graphsplit api`åˆ é™¤ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå…ƒæ•°æ®æ–‡ä»¶ä¸­çš„åŸæ–‡ä»¶çš„MD5å€¼ä¸ä¼šè¢«åˆ›å»ºã€‚

æ„Ÿè°¢filedriveå›¢é˜Ÿä¸ºæ­¤åšå‡ºçš„è´¡çŒ®ï¼Œæ›´å¤šä¿¡æ¯å¯ä»¥æŸ¥çœ‹è¿™é‡Œï¼š[https://github.com/filedrive-team/go-graphsplit](https://github.com/filedrive-team/go-graphsplit).

#### é€‰é¡¹3ï¸âƒ£ é€šè¿‡IPFSçš„ Web API <a href="#xuan-xiang-three-tong-guo-ipfs-de-webapi" id="xuan-xiang-three-tong-guo-ipfs-de-webapi"></a>

ğŸ”” è¯¥é€‰é¡¹å°†ä½¿ç”¨ipfs web apiå°†æºç›®å½•ä¸‹çš„æ–‡ä»¶åˆå¹¶åˆ°è¾“å‡ºç›®å½•ä¸­çš„ä¸€ä¸ªCaræ–‡ä»¶ã€‚

```shell
./swan-client ipfscar -input-dir [input_files_dir] -out-dir [car_file_output_dir]
```

**æ­¤å‘½ä»¤ç›¸å…³å‚æ•°å¦‚ä¸‹:**

* \-input-dir(å¿…é€‰): æºæ–‡ä»¶æ‰€åœ¨è·¯å¾„
* \-out-dir(å¯é€‰): ç”Ÿæˆçš„Caræ–‡ä»¶å’Œå…ƒæ•°æ®æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼Œå½“ç¼ºçœæ—¶ï¼Œä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„`[sender].output_dir`

**æ­¤æ­¥éª¤ç”¨åˆ°çš„é…ç½®é¡¹:**

* \[lotus].client\_api\_url, è§é…ç½®æ–‡ä»¶
* \[lotus].client\_access\_token, è§é…ç½®æ–‡ä»¶
* \[sender].output\_dir, åªæœ‰å½“å‘½ä»¤ä¸­`-out-dir`ç¼ºçœæ—¶æ‰ä¼šè¢«ä½¿ç”¨, è§é…ç½®æ–‡ä»¶
* \[sender].generate\_md5, å½“è®¾ç½®ä¸ºtrueæ—¶ï¼Œä¼šç”Ÿæˆæºæ–‡ä»¶å’ŒCaræ–‡ä»¶çš„md5, è§é…ç½®æ–‡ä»¶
* \[ipfs\_server].upload\_url\_prefix, è§é…ç½®æ–‡ä»¶

**æ­¤æ­¥éª¤ä¹‹åç”Ÿæˆçš„æ–‡ä»¶:**

* car.json: åŒ…å«Caræ–‡ä»¶çš„ä¿¡æ¯ï¼Œè§ç¦»çº¿äº¤æ˜“
* \[car-file-cid].car: è¿™äº›æ–‡ä»¶å°†ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªCaræ–‡ä»¶

#### é€‰é¡¹4ï¸âƒ£ é€šè¿‡`ipfs-car`å‘½ä»¤ <a href="#xuan-xiang-four-tong-guo-ipfscar-ming-ling" id="xuan-xiang-four-tong-guo-ipfscar-ming-ling"></a>

ğŸ”” ä½¿ç”¨ä¹‹å‰å¿…é¡»ç¡®ä¿å·²ç»å®‰è£…`ipfs-car`

```shell
sudo npm install -g ipfs-car
```

ğŸ”” è¯¥é€‰é¡¹å°†ä½¿ç”¨`ipfs-car`å‘½ä»¤å°†æºç›®å½•ä¸‹çš„æ–‡ä»¶åˆå¹¶åˆ°è¾“å‡ºç›®å½•ä¸­çš„ä¸€ä¸ªCaræ–‡ä»¶ã€‚

```shell
./swan-client ipfscmdcar -input-dir [input_files_dir] -out-dir [car_file_output_dir]
```

**æ­¤æ­¥éª¤ä½¿ç”¨çš„å‘½ä»¤å‚æ•°:**

* \-input-dir(å¿…é€‰)ï¼šæºæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ã€‚
* \-out-dir(å¯é€‰): ç”Ÿæˆçš„Caræ–‡ä»¶å’Œå…ƒæ•°æ®æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼Œå½“ç¼ºçœæ—¶ï¼Œä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„`[sender].output_dir`

**æ­¤æ­¥éª¤ç”¨åˆ°çš„é…ç½®é¡¹:**

* \[lotus].client\_api\_url, è§é…ç½®æ–‡ä»¶
* \[lotus].client\_access\_token, è§é…ç½®æ–‡ä»¶
* \[sender].output\_dir, åªæœ‰å½“å‘½ä»¤ä¸­`-out-dir`ç¼ºçœæ—¶æ‰ä¼šè¢«ä½¿ç”¨, è§é…ç½®æ–‡ä»¶
* \[sender].generate\_md5, å½“è®¾ç½®ä¸ºtrueæ—¶ï¼Œä¼šç”Ÿæˆæºæ–‡ä»¶å’ŒCaræ–‡ä»¶çš„md5, è§é…ç½®æ–‡ä»¶

**æ­¤æ­¥éª¤ä¹‹åç”Ÿæˆçš„æ–‡ä»¶:**

* car.json: åŒ…å«Caræ–‡ä»¶çš„ä¿¡æ¯ï¼Œè§ç¦»çº¿äº¤æ˜“
* \[source-files-dir-name].car: ç”±æºæ–‡ä»¶åˆå¹¶åç”Ÿæˆçš„Caræ–‡ä»¶
