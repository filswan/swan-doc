# 3.1å‡†å¤‡å‘é€äº¤æ˜“çš„æ•°æ®

## åˆ›å»ºcaræ–‡ä»¶

* ğŸ””è¾“å…¥è·¯å¾„å’Œè¾“å‡ºè·¯å¾„åªèƒ½æ˜¯ç»å¯¹è·¯å¾„ã€‚
* ğŸ””æ­¤æ­¥éª¤å¯¹äºå…¬å¼€äº¤æ˜“å’Œç§æœ‰äº¤æ˜“éƒ½æ˜¯å¿…éœ€çš„ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©ä¸€ä¸‹ä¸‰ç§æ–¹å¼ä¸­çš„ä»»æ„ä¸€ç§

#### é€‰é¡¹ä¸€ é€šè¿‡lotusä¸­web json rpc çš„APIå®ç°

ğŸ””  è¿™ä¸ªé€‰é¡¹å°†ä¸ºæºç›®å½•ä¸­çš„æ¯ä¸ªæ–‡ä»¶ç”Ÿæˆä¸€ä¸ªcaræ–‡ä»¶

```
./swan-client car -input-dir [input_files_dir] -out-dir [car_files_output_dir]
```

**æ­¤å‘½ä»¤ç›¸å…³å‚æ•°å¦‚ä¸‹ï¼š**

* \-input-dir(å¿…å¡«)ï¼šæºæ–‡ä»¶æ‰€åœ¨è·¯å¾„
* \-out-dir(å¯é€‰)ï¼šç”Ÿæˆçš„caræ–‡ä»¶å’Œå…ƒæ•°æ®æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼Œå½“ç¼ºçœæ—¶ï¼Œä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„\[sender].output\_dir\


**æ­¤æ­¥éª¤ç”¨åˆ°çš„é…ç½®é¡¹ï¼š**

* \[lotus].client\_api\_url, è§é…ç½®æ–‡ä»¶
* \[lotus].client\_access\_token, è§é…ç½®æ–‡ä»¶
* \[sender].output\_dir, åªæœ‰å½“å‘½ä»¤ä¸­-out-dirç¼ºçœæ—¶æ‰ä¼šè¢«ä½¿ç”¨ï¼Œè§é…ç½®æ–‡ä»¶
* \[sender].generate\_md5, å½“è®¾ç½®ä¸ºtrueæ—¶ï¼Œä¼šç”Ÿæˆæºæ–‡ä»¶å’Œcaræ–‡ä»¶çš„md5ï¼Œè§é…ç½®æ–‡ä»¶

**æ­¤æ­¥éª¤ä¹‹åç”Ÿæˆçš„æ–‡ä»¶ï¼š**

* car.csvï¼šåŒ…å«æºæ–‡ä»¶å’Œcaræ–‡ä»¶çš„ä¿¡æ¯ï¼›
* car.jsonï¼šåŒ…å«æºæ–‡ä»¶å’Œcaræ–‡ä»¶çš„ä¿¡æ¯ï¼Œè§ç¦»çº¿äº¤æ˜“
* \[source-file-name].carï¼šæ¯ä¸ªæºæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„caræ–‡ä»¶

#### é€‰é¡¹äºŒ é€šè¿‡graphsplit çš„APIå®ç°

ğŸ”” æ­¤é€‰é¡¹å¯ä»¥å°†åŸè·¯å¾„ä¸‹çš„ä¸€ä¸ªæ–‡ä»¶åˆ†å‰²æˆç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªcaræ–‡ä»¶ï¼Œå¹¶ä¸”ä¿å­˜åˆ°è¾“å‡ºè·¯å¾„ä¸­ã€‚

```
./swan-client gocar -input-dir [input_files_dir] -out-dir [car_files_output_dir]
```

**æ­¤æ­¥éª¤ä¸­ç”¨åˆ°çš„å‘½ä»¤å‚æ•°ï¼š**

* \-input-dir(å¿…å¡«)ï¼šæºæ–‡ä»¶æ‰€åœ¨è·¯å¾„
* \-out-dir(å¯é€‰)ï¼šç”Ÿæˆçš„caræ–‡ä»¶å’Œå…ƒæ•°æ®æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼Œå½“ç¼ºçœæ—¶ï¼Œä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„\[sender].output\_dir

**æ­¤æ­¥éª¤ç”¨åˆ°çš„é…ç½®é¡¹ï¼š**

* \[lotus].client\_api\_url, è§é…ç½®æ–‡ä»¶
* \[lotus].client\_access\_token, è§é…ç½®æ–‡ä»¶
* \[sender].gocar\_file\_size\_limit, è§é…ç½®æ–‡ä»¶
* \[sender].gocar\_folder\_based, è§é…ç½®æ–‡ä»¶
* \[sender].output\_dir, åªæœ‰å½“å‘½ä»¤ä¸­-out-dirç¼ºçœæ—¶æ‰ä¼šè¢«ä½¿ç”¨ï¼Œè§é…ç½®æ–‡ä»¶
* \[sender].generate\_md5, å½“è®¾ç½®ä¸ºtrueæ—¶ï¼Œä¼šç”Ÿæˆæºæ–‡ä»¶å’Œcaræ–‡ä»¶çš„md5ï¼Œè§é…ç½®æ–‡ä»¶

**æ­¤æ­¥éª¤ä¹‹åç”Ÿæˆçš„æ–‡ä»¶ï¼š**

* manifest.csvï¼šé€šè¿‡graphsplit apiç”Ÿæˆ
* car.csvï¼šæ ¹æ®manifest.csvç”Ÿæˆï¼ŒåŒ…å«æºæ–‡ä»¶å’Œcaræ–‡ä»¶çš„ä¿¡æ¯ï¼Œ
* car.jsonï¼šæ ¹æ®manifest.csvç”Ÿæˆï¼ŒåŒ…å«æºæ–‡ä»¶å’Œcaræ–‡ä»¶çš„ä¿¡æ¯ï¼Œè§ç¦»çº¿äº¤æ˜“
* \[hash-value-of-file-part].carï¼šå¦‚æœgocar\_folder\_based=trueï¼Œè·¯å¾„ä¸‹é¢ä¼šæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªcaæ–‡ä»¶ï¼Œå¦åˆ™æ¯ä¸ªæºæ–‡ä»¶ä¼šæ ¹æ®æ–‡ä»¶å¤§å°å’Œ\[sender].gocar\_file\_size\_limit ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªcaræ–‡ä»¶ä¸ä¹‹ç›¸å¯¹åº”

æ³¨æ„ï¼š

* å¦‚æœæºæ–‡ä»¶çš„å¤§å°è¦å¤§äº\[sender].gocar\_file\_size\_limit ï¼Œåœ¨å…ƒæ•°æ®æ–‡ä»¶ä¸­çš„åŸæ–‡ä»¶ä¿¡æ¯æ˜¯ç”±graphsplit api ä¸´æ—¶ç”Ÿæˆçš„ï¼Œåœ¨ç”Ÿæˆcaræ–‡ä»¶ä¹‹åï¼Œè¿™äº›ä¸´æ—¶æ€§çš„åŸæ–‡ä»¶å°†ä¼šè¢«graphsplit api åˆ é™¤ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå…ƒæ•°æ®æ–‡ä»¶ä¸­çš„åŸæ–‡ä»¶çš„MD5å€¼ä¸ä¼šè¢«åˆ›å»ºã€‚

æ„Ÿè°¢filedriveå›¢é˜Ÿä¸ºæ­¤åšå‡ºçš„è´¡çŒ®ï¼Œæ›´å¤šä¿¡æ¯å¯ä»¥æŸ¥çœ‹è¿™é‡Œï¼š[https://github.com/filedrive-team/go-graphsplit](https://github.com/filedrive-team/go-graphsplit).

#### é€‰é¡¹ä¸‰ é€šè¿‡IPFS çš„APIå®ç°

ğŸ”” æ­¤é€‰é¡¹ä¸‹ï¼ŒåŸæ–‡ä»¶è·¯å¾„ä¸‹çš„æ–‡ä»¶ä¼šè¢«åˆå¹¶ä¸ºä¸€ä¸ªcaræ–‡ä»¶å¹¶ä¸”ä¿å­˜åˆ°è¾“å‡ºè·¯å¾„ä¸‹ã€‚

```
./swan-client ipfscar -input-dir [input_files_dir] -out-dir [car_file_output_dir]
```

**æ­¤æ­¥éª¤ä¸­ç”¨åˆ°çš„å‘½ä»¤å‚æ•°ï¼š**

* \-input-dir(å¿…å¡«)ï¼šæºæ–‡ä»¶æ‰€åœ¨è·¯å¾„
* \-out-dir(å¯é€‰)ï¼šç”Ÿæˆçš„caræ–‡ä»¶å’Œå…ƒæ•°æ®æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼Œå½“ç¼ºçœæ—¶ï¼Œä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„\[sender].output\_dir

**æ­¤æ­¥éª¤ç”¨åˆ°çš„é…ç½®é¡¹ï¼š**

* \[lotus].client\_api\_url, è§é…ç½®æ–‡ä»¶
* \[lotus].client\_access\_token, è§é…ç½®æ–‡ä»¶
* \[sender].output\_dir, åªæœ‰å½“å‘½ä»¤ä¸­-out-dirç¼ºçœæ—¶æ‰ä¼šè¢«ä½¿ç”¨ï¼Œè§é…ç½®æ–‡ä»¶
* \[sender].generate\_md5, å½“è®¾ç½®ä¸ºtrueæ—¶ï¼Œä¼šç”Ÿæˆæºæ–‡ä»¶å’Œcaræ–‡ä»¶çš„md5ï¼Œè§é…ç½®æ–‡ä»¶
* \[ipfs\_server].upload\_url\_prefix, è§é…ç½®æ–‡ä»¶

**æ­¤æ­¥éª¤ä¹‹åç”Ÿæˆçš„æ–‡ä»¶ï¼š**

* car.csvï¼šæ ¹æ®manifest.csvç”Ÿæˆï¼ŒåŒ…å«æºæ–‡ä»¶å’Œcaræ–‡ä»¶çš„ä¿¡æ¯ï¼Œ
* car.jsonï¼šæ ¹æ®manifest.csvç”Ÿæˆï¼ŒåŒ…å«æºæ–‡ä»¶å’Œcaræ–‡ä»¶çš„ä¿¡æ¯ï¼Œè§ç¦»çº¿äº¤æ˜“
* \[car-file-cid].carï¼šè¿™äº›æ–‡ä»¶å°†ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªcaræ–‡ä»¶

æ³¨æ„ï¼šå…ƒæ•°æ®æ–‡ä»¶ä¸­ä¸ä¼šåˆ›å»ºåŸæ–‡ä»¶çš„MD5å€¼
